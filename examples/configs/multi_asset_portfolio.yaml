# Multi-Asset Portfolio Strategy Configuration
#
# This configuration demonstrates a portfolio strategy with multiple assets,
# signals, and market context for risk management.
#
# Usage:
#   from pathlib import Path
#   from ml4t.backtest.config import BacktestConfig
#   config = BacktestConfig.from_yaml(Path("multi_asset_portfolio.yaml"))

name: multi_asset_momentum
description: |
  Multi-asset momentum strategy trading 10 stocks.
  Uses precomputed momentum signals and VIX for risk filtering.
  Rebalances weekly, maximum 10% per position.

# Data Sources
data_sources:
  # Price data for all assets
  prices:
    path: ${DATA_PATH}/sp500_top10_prices.parquet
    format: parquet
    timestamp_column: timestamp
    asset_column: asset_id

  # Momentum signals (weekly rebalancing)
  signals:
    path: ${DATA_PATH}/sp500_top10_momentum_signals.parquet
    format: parquet
    columns:
      - timestamp
      - asset_id
      - signal  # Target position weight (-1.0 to 1.0)
      - momentum_score  # 12-month momentum rank
      - rank  # Relative rank in universe

  # Market context for risk filtering
  context:
    path: ${DATA_PATH}/market_context.parquet
    format: parquet
    columns:
      - timestamp
      - vix  # VIX volatility index
      - spy_return  # SPY daily return
      - market_regime  # 0=bear, 1=neutral, 2=bull

# Feature Provider for technical indicators
features:
  type: precomputed
  path: ${DATA_PATH}/sp500_top10_features.parquet
  columns:
    - atr  # Average True Range
    - volatility  # 20-day historical volatility
    - volume_ma  # 20-day average volume
  timestamp_column: timestamp
  asset_column: asset_id

# Execution Parameters
execution:
  initial_capital: 1000000

  commission:
    type: percentage
    rate: 0.001  # 0.1% per trade (institutional rates)

  slippage:
    type: volume_share
    rate: 0.1  # 10% of volume share impact

  enable_margin: false
  max_leverage: 1.0
  execution_delay: true
  allow_immediate_reentry: true

# Risk Rules
risk_rules:
  max_position_size: 0.15  # Maximum 15% per position
  max_portfolio_heat: 0.25  # Maximum 25% total portfolio risk

  # VIX filtering: Don't trade when VIX is extreme
  min_vix: 10.0
  max_vix: 40.0

  # Individual position risk
  stop_loss: 0.08  # 8% stop loss per position
  take_profit: 0.25  # 25% take profit per position
